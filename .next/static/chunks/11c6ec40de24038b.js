(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,58299,e=>{"use strict";var t=e.i(50795);function s({children:e}){return(0,t.jsx)("span",{className:"inline-flex items-center rounded-full border border-zinc-200 bg-white px-2.5 py-1 text-xs text-zinc-700",children:e})}e.s(["default",()=>s])},40161,e=>{"use strict";var t=e.i(50795),s=e.i(36211),l=e.i(33209);function n(e){let t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return`${t}-${s}-${l}`}function i(e,t){let s=new Date(e);return s.setDate(s.getDate()+t),s}function r(e){return new Intl.NumberFormat("ru-RU").format(e)+" ₽"}function a({days:e,value:s,onChange:n,hotDays:i,premiumDays:r}){return(0,t.jsxs)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-3",children:[(0,t.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-1 [-webkit-overflow-scrolling:touch]",children:e.map(e=>{let a=e===s,d=i?.has(e),c=r?.has(e);return(0,t.jsxs)("button",{onClick:()=>n(e),className:(0,l.cn)("relative min-w-[92px] flex-shrink-0 rounded-2xl border px-3 py-2 text-left transition",a?"border-zinc-900 bg-zinc-900 text-white":"border-zinc-200 bg-white text-zinc-800 hover:bg-zinc-50"),children:[(0,t.jsxs)("div",{className:"absolute right-2 top-2 flex items-center gap-1",children:[c?(0,t.jsx)("span",{className:(0,l.cn)("h-2 w-2 rounded-full",a?"bg-sky-300":"bg-sky-500"),"aria-label":"Высокий тариф",title:"Высокий тариф"}):null,d?(0,t.jsx)("span",{className:(0,l.cn)("h-2 w-2 rounded-full",a?"bg-red-300":"bg-red-500"),"aria-label":"Горящие слоты",title:"Горящие слоты"}):null]}),(0,t.jsx)("div",{className:(0,l.cn)("text-xs",a?"text-white/80":"text-zinc-500"),children:function(e){let[t,s,l]=e.split("-").map(Number),n=new Date(t,s-1,l);return new Intl.DateTimeFormat("ru-RU",{weekday:"short"}).format(n)}(e)}),(0,t.jsx)("div",{className:"mt-0.5 text-sm font-semibold",children:function(e){let[t,s,l]=e.split("-").map(Number),n=new Date(t,s-1,l);return new Intl.DateTimeFormat("ru-RU",{day:"numeric",month:"short"}).format(n)}(e)})]},e)})}),(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap gap-3 px-1 text-[11px] text-zinc-500",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"h-2 w-2 rounded-full bg-sky-500"})," высокий тариф"]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"h-2 w-2 rounded-full bg-red-500"})," горящие слоты"]})]})]})}var d=e.i(58299);let c=e=>`slot_booking_${e}`;function o(e){let t=window.localStorage.getItem(c(e));if(!t)return{status:"none",updatedAt:0};try{let e=JSON.parse(t);if(!e?.status)return{status:"none",updatedAt:0};return e}catch{if("booked"===t)return{status:"booked",updatedAt:Date.now()};return{status:"none",updatedAt:0}}}function x(e,t){let s={status:t,updatedAt:Date.now()};window.localStorage.setItem(c(e),JSON.stringify(s))}function m({slot:e,onBook:l}){let[n,i]=(0,s.useState)("none");(0,s.useEffect)(()=>{i(o(e.id).status)},[e.id]);let a=e.pay>=3500;return(0,t.jsxs)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-5",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsx)("div",{className:"text-base font-semibold",children:e.title}),e.hot?(0,t.jsx)("span",{className:"inline-flex items-center rounded-full bg-red-50 px-2 py-0.5 text-xs font-medium text-red-700",children:"Горящий"}):null,a?(0,t.jsx)("span",{className:"inline-flex items-center rounded-full bg-sky-50 px-2 py-0.5 text-xs font-medium text-sky-700",children:"Высокий тариф"}):null,"booked"===n?(0,t.jsx)("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-xs font-medium text-emerald-700",children:"Записан"}):null,"cancelled"===n?(0,t.jsx)("span",{className:"inline-flex items-center rounded-full bg-zinc-100 px-2 py-0.5 text-xs font-medium text-zinc-600",children:"Отменено"}):null,"completed"===n?(0,t.jsx)("span",{className:"inline-flex items-center rounded-full bg-zinc-900 px-2 py-0.5 text-xs font-medium text-white",children:"Завершено"}):null]}),(0,t.jsxs)("div",{className:"mt-1 text-sm text-zinc-600",children:[e.company," · ",e.city]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-base font-semibold",children:r(e.pay)}),(0,t.jsx)("div",{className:"mt-1 text-xs text-zinc-500",children:e.time})]})]}),(0,t.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:e.tags.map(e=>(0,t.jsx)(d.default,{children:e},e))}),(0,t.jsx)("div",{className:"mt-3 text-sm text-zinc-600",children:e.address}),"booked"===n?(0,t.jsxs)("div",{className:"mt-4 grid gap-2",children:[(0,t.jsx)("button",{onClick:()=>{x(e.id,"cancelled"),i("cancelled")},className:"inline-flex w-full items-center justify-center rounded-xl border border-zinc-200 bg-white px-4 py-3 text-sm font-medium text-zinc-900",children:"Отменить запись"}),(0,t.jsx)("button",{onClick:()=>{x(e.id,"completed"),i("completed")},className:"inline-flex w-full items-center justify-center rounded-xl bg-zinc-900 px-4 py-3 text-sm font-medium text-white",children:"Отметить как завершено (demo)"})]}):"completed"===n?(0,t.jsx)("div",{className:"mt-4 rounded-xl border border-zinc-200 bg-zinc-50 p-3 text-sm text-zinc-700",children:"Смена завершена. Оценка смены — в профиле."}):(0,t.jsx)("button",{onClick:()=>l(e),className:"mt-4 inline-flex w-full items-center justify-center rounded-xl bg-zinc-900 px-4 py-3 text-sm font-medium text-white",children:"Записаться"})]})}function u(e){let[t,s]=e.split("–").map(e=>e.trim()),[l,n]=(t??"00:00").split(":").map(Number),[i,r]=(s??"00:00").split(":").map(Number);return{start:60*(l||0)+(n||0),end:60*(i||0)+(r||0)}}function f(e,t){return e.start<t.end&&t.start<e.end}function p({open:e,onClose:l,days:n,slots:i,hotDays:d,premiumDays:c,initialDay:m,initialTitle:p}){let[h,b]=(0,s.useState)(m),[j,g]=(0,s.useState)([]),[N,w]=(0,s.useState)(!0),[y,v]=(0,s.useState)(null);(0,s.useEffect)(()=>{e&&(b(m),g([]),w(!0),v(null))},[e,m]);let z=(0,s.useMemo)(()=>i.filter(e=>e.date===h).sort((e,t)=>u(e.time).start-u(t.time).start),[i,h]),k=(0,s.useMemo)(()=>z.map(e=>e.id),[z]),D=(0,s.useMemo)(()=>{let e=new Map;for(let t of z)e.set(t.id,t);return e},[z]),S=(0,s.useMemo)(()=>j.map(e=>D.get(e)).filter(Boolean),[j,D]),C=(0,s.useMemo)(()=>S.reduce((e,t)=>e+t.pay,0),[S]),M=e=>"booked"===o(e).status,T=e=>{let t=D.get(e);if(!t)return!1;let s=u(t.time);for(let t of j){if(t===e)continue;let l=D.get(t);if(l&&f(s,u(l.time)))return!1}for(let t of z)if(M(t.id)&&t.id!==e&&f(s,u(t.time)))return!1;return!0},I=e=>{if(!N||0===j.length)return!0;let t=k.indexOf(e);if(-1===t)return!1;let s=j.map(e=>k.indexOf(e)).filter(e=>e>=0).sort((e,t)=>e-t),l=s[0],n=s[s.length-1];return t===l-1||t===n+1},A=e=>!!j.includes(e)||!M(e)&&!!T(e)&&!!I(e);return e?(0,t.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:l}),(0,t.jsx)("div",{className:"absolute left-1/2 top-4 w-[min(560px,calc(100%-16px))] -translate-x-1/2",children:(0,t.jsxs)("div",{className:"rounded-2xl border border-zinc-200 bg-white shadow-lg",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3 border-b border-zinc-200 p-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-zinc-500",children:"Запись на слоты"}),(0,t.jsx)("div",{className:"text-base font-semibold",children:p??"Выбери дату и слоты"})]}),(0,t.jsx)("button",{onClick:l,className:"rounded-xl border border-zinc-200 bg-white px-3 py-2 text-sm",children:"Закрыть"})]}),(0,t.jsxs)("div",{className:"space-y-3 p-4",children:[(0,t.jsx)(a,{days:n,value:h,onChange:e=>{b(e),g([]),v(null)},hotDays:d,premiumDays:c}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-zinc-200 bg-white p-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:"Выбирать “подряд”"}),(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Вкл — только соседние слоты, плюс запрет пересечений по времени."})]}),(0,t.jsx)("button",{onClick:()=>{w(e=>!e),g([]),v(null)},className:"rounded-xl border border-zinc-200 bg-white px-3 py-2 text-sm",children:N?"Вкл":"Выкл"})]}),y?(0,t.jsx)("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 p-3 text-sm text-rose-800",children:y}):null,0===z.length?(0,t.jsx)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4 text-sm text-zinc-600",children:"На этот день слотов нет. Листай табы сверху."}):(0,t.jsx)("div",{className:"space-y-2",children:z.map(e=>{let s=j.includes(e.id),l=M(e.id),n=!s&&!A(e.id);return(0,t.jsx)("button",{onClick:()=>{var t;return t=e.id,void g(e=>e.includes(t)?(v(null),e.filter(e=>e!==t)):A(t)?(v(null),[...e,t]):(M(t)?v("Этот слот уже забронирован."):T(t)?I(t)?v("Нельзя выбрать этот слот."):v("В режиме “подряд” можно добавлять только соседние слоты (слева/справа)."):v("Нельзя выбрать: слот пересекается по времени с выбранным или уже забронированным."),e))},disabled:n,className:["w-full rounded-2xl border p-4 text-left transition",s?"border-zinc-900 bg-zinc-50":"border-zinc-200 hover:bg-zinc-50",n?"opacity-50 cursor-not-allowed":""].join(" "),title:l?"Уже записан на этот слот":void 0,children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:["inline-flex h-5 w-5 items-center justify-center rounded-md border text-xs",s?"border-zinc-900 bg-zinc-900 text-white":"border-zinc-300 bg-white"].join(" "),children:s?"✓":""}),(0,t.jsxs)("div",{className:"font-semibold",children:[e.title,e.hot?(0,t.jsx)("span",{className:"ml-2 text-xs text-red-600",children:"• горячий"}):null,e.pay>=3500?(0,t.jsx)("span",{className:"ml-2 text-xs text-sky-700",children:"• высокий тариф"}):null,l?(0,t.jsx)("span",{className:"ml-2 text-xs text-emerald-700",children:"• уже записан"}):null]})]}),(0,t.jsxs)("div",{className:"mt-1 text-sm text-zinc-600",children:[e.company," · ",e.city]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:e.time}),(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:r(e.pay)})]})]})},e.id)})}),(0,t.jsxs)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-zinc-600",children:"Выбрано слотов:"}),(0,t.jsx)("span",{className:"font-semibold",children:j.length})]}),(0,t.jsxs)("div",{className:"mt-1 flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-zinc-600",children:"Итого оплата:"}),(0,t.jsx)("span",{className:"font-semibold",children:r(C)})]})]}),(0,t.jsxs)("button",{disabled:0===j.length,onClick:()=>{let e=S.map(e=>({id:e.id,r:u(e.time)}));for(let t=0;t<e.length;t++)for(let s=t+1;s<e.length;s++)if(f(e[t].r,e[s].r))return void v("Есть пересекающиеся по времени слоты. Убери конфликт и попробуй снова.");for(let e of j)x(e,"booked");l()},className:"inline-flex w-full items-center justify-center rounded-xl bg-zinc-900 px-4 py-3 text-sm font-medium text-white disabled:opacity-50",children:["Подтвердить запись (",j.length,")"]}),(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"UI-only: бронь сохраняется в localStorage. Пересечения по времени запрещены."})]})]})})]}):null}function h(){var e;let[l,r]=(0,s.useState)(""),[d,c]=(0,s.useState)(()=>new Date),[o,x]=(0,s.useState)(()=>n(new Date)),u=(0,s.useMemo)(()=>(function(e,t=14){let s=[];for(let l=0;l<t;l++)s.push(n(i(e,l)));return s})(d,14),[d]),f=(0,s.useMemo)(()=>(function(e,t=14){let s=[];for(let l=0;l<t;l++){let t=n(i(e,l)),r=l%4==0?0:l%2==0?2:1,a=l%3==0;for(let e=0;e<r;e++){let l=`${t}-slot-${e+1}`,n=a&&0===e,i=e%3,r=0===i?{title:"Повар-универсал",company:"Кафе «Лимон»",city:"Берлин",address:"Warschauer Str. 12",time:"10:00–19:00",pay:3500,tags:["Питание","Форма"]}:1===i?{title:"Официант",company:"Ресторан «Север»",city:"Берлин",address:"Prenzlauer Allee 77",time:"12:00–21:00",pay:2800,tags:["Чаевые","Обучение"]}:{title:"Кладовщик",company:"Склад «Nord»",city:"Потсдам",address:"Industriestr. 4",time:"08:00–17:00",pay:3200,tags:["Тёплый склад"]};s.push({id:l,date:t,hot:n,...r})}}return s})(d,14),[d]),h=(0,s.useMemo)(()=>{let e=new Set;for(let t of f)t.hot&&e.add(t.date);return e},[f]),b=(0,s.useMemo)(()=>{let e=new Set;for(let t of f)t.pay>=3500&&e.add(t.date);return e},[f]);e=(0,s.useCallback)(e=>{c(e),x(n(e))},[]),(0,s.useEffect)(()=>{let t=()=>e(new Date),s=new Date,l=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1,0,0,2).getTime()-s.getTime(),n=window.setTimeout(()=>{t(),n._t2=window.setInterval(t,6e4)},l);return()=>{let e=n?._t2;e&&window.clearInterval(e),window.clearTimeout(n)}},[e]),(0,s.useEffect)(()=>{0!==u.length&&(u.includes(o)||x(u[0]))},[u,o]);let j=(0,s.useMemo)(()=>{let e=l.trim().toLowerCase();return f.filter(e=>e.date===o).filter(t=>!e||[t.title,t.company,t.city].some(t=>t.toLowerCase().includes(e)))},[l,o,f]),[g,N]=(0,s.useState)(!1),[w,y]=(0,s.useState)(null),v=(0,s.useCallback)(()=>N(!1),[]),z=(0,s.useCallback)(e=>{y({day:e.date,title:e.title}),N(!0)},[]);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(a,{days:u,value:o,onChange:x,hotDays:h,premiumDays:b}),(0,t.jsx)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:(0,t.jsx)("input",{value:l,onChange:e=>r(e.target.value),placeholder:"Поиск: профессия, компания, город…",className:"w-full rounded-xl border border-zinc-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-zinc-900/10"})}),0===j.length?(0,t.jsx)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-5 text-sm text-zinc-600",children:"На выбранную дату слотов нет. Листай дни табами сверху."}):(0,t.jsx)("div",{className:"space-y-3",children:j.map(e=>(0,t.jsx)(m,{slot:e,onBook:z},e.id))}),(0,t.jsx)(p,{open:g,onClose:v,days:u,slots:f,hotDays:h,premiumDays:b,initialDay:w?.day??o,initialTitle:w?.title})]})}e.s(["default",()=>h],40161)}]);